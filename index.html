<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="assets/css/reset.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <title>Document</title>
</head>
<body>
    <div id="all-characters" class="row"><h3>Your Character</h3></div>
    <hr>
    <div id="enemies-available" class="row"><h3>Enemies Available to Attack</h3></div>
    <hr>
    <div id="fight-section"><h3>Fight Section</h3><button id="fight-button">Fight!</button></div>
    <hr>
    <div id="defender" class="row"><h3>Defender</h3></div>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- <script src="assets/javascript/game.js"></script> -->
    <script>
    
        const charactersInitialState = {
            "Obi-Wan-Kenobi": {
                name: "Obi-Wan-Kenobi",
                hp: 120,
                "attack-power": 6,
               "counter-Attack-Power": 6
            },
            "Luke-Skywalker": {
                name: "Luke-Skywalker",
                hp: 100,
                "attack-power": 4,
                "counter-Attack-Power": 4
            },
            "Darth-Sidious": {
                name: "Darth-Sidious",
                hp: 150,
                "attack-power": 10,
                "counter-Attack-Power": 10
            },
            "Darth-Maul": {
                name: "Darth-Maul",
                hp: 180,
                "attack-power": 8,
                "counter-Attack-Power": 8
            }
        };   

        const charactersDeepCopy = JSON.parse(JSON.stringify(charactersInitialState));

        const game = {
            selectedCharacter: "",
            selectedDefender: "",
            gameFinished: false,
            fight(selectedCharacter, defender) { // (str, str)
                const chosenCharacterAttack = charactersDeepCopy[selectedCharacter]["attack-power"];
                charactersDeepCopy[selectedCharacter].hp -= charactersDeepCopy[defender]["counter-Attack-Power"];
                charactersDeepCopy[defender].hp -= chosenCharacterAttack;
                charactersDeepCopy[selectedCharacter]["attack-power"] += chosenCharacterAttack;
            }
        }

        $(document).ready(function() {
                    

            Object.values(charactersDeepCopy).forEach(stats => {
                const characterBox = $("<div>");
                const name = $("<div>");
                name.text(stats.name);

                const hp = $("<div>");
                const attack = $("<div>")
                hp.text("Health: " + stats["hp"]);
                hp.attr("class", "hp");
                attack.text("Attack: " + stats["attack-power"]);
                attack.attr("class", "attack")

                characterBox
                    .addClass("character-box")
                    .attr("name", stats.name)
                    .attr("hp", stats.hp)
                    .attr("attack-power", stats["base-attack"])
                    .attr("counter-attack-power", stats["base-attack"])
                    .attr("id", stats.name)
                    .append(name)
                    .append(hp)
                    .append(attack)
                    
                $("#all-characters").append(characterBox);
            });

            $("#fight-button").click(() => {

                if (game.gameFinished || !game.selectedCharacter || !game.selectedDefender) {
                    return
                }
                const selectedCharacter = game.selectedCharacter
                const defender = game.selectedDefender
                game.fight(selectedCharacter, defender);
                const selectedCharacterObj =  $("#" + selectedCharacter);
                selectedCharacterObj
                    .children(".hp")
                    .text("Health: " + charactersDeepCopy[selectedCharacter].hp)
                selectedCharacterObj
                    .children(".attack")
                    .text("Attack: " + charactersDeepCopy[selectedCharacter]["attack-power"]);
                $("#" + defender)
                    .children(".hp")
                    .text("Health: " + charactersDeepCopy[defender].hp);
                
           
                
                

            })
            
            $(".character-box").click(function() {
                const box = $(this);
                
                if (!game.selectedCharacter) {
                    box.css("background", "green"); // Change to style.css
                    const x = $("#all-characters").children(".character-box").each(function(item) {
                        if (!$(this).is(box)) {
                            $("#enemies-available").append($(this));
                        }
                    });      
                    game.selectedCharacter = box.attr("name");
                } else if (!game.selectedDefender && game.selectedCharacter)  {           
                   $("#defender").append(box);
                   game.selectedDefender = box.attr("name");      
                }
               
            });

        });
    
    </script>
    
</body>
</html>